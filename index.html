<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Power BI & Video Switcher</title>
  <script src="https://alcdn.msauth.net/browser/2.35.0/js/msal-browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/powerbi-client@2.19.1/dist/powerbi.min.js"></script>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; }
    #container { width: 100%; height: 100vh; display: flex; align-items: center; justify-content: center; }
    #reportContainer, #videoContainer { width: 100%; height: 100%; display: none; }
    iframe, video { width: 100%; height: 100%; border: none; }
  </style>
</head>
<body>
  <div id="container">
    <div id="reportContainer"></div>
    <div id="videoContainer">
      <video id="video" muted autoplay loop>
        <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
    </div>
  </div>

  <script>
    const msalConfig = {
      auth: {
        clientId: "YOUR_CLIENT_ID", // Replace with your Azure AD App client ID
        authority: "https://login.microsoftonline.com/YOUR_TENANT_ID", // Replace with your tenant
        redirectUri: window.location.href
      }
    };

    const msalInstance = new msal.PublicClientApplication(msalConfig);
    const loginRequest = {
      scopes: ["https://analysis.windows.net/powerbi/api/.default"]
    };

    async function signInAndEmbed() {
      try {
        const account = (await msalInstance.loginPopup(loginRequest)).account;
        msalInstance.setActiveAccount(account);

        const tokenResponse = await msalInstance.acquireTokenSilent(loginRequest);
        const accessToken = tokenResponse.accessToken;

        const embedConfig = {
          type: 'report',
          id: "YOUR_REPORT_ID", // Replace with your report ID
          embedUrl: "YOUR_EMBED_URL", // Replace with your embed URL
          accessToken: accessToken,
          tokenType: powerbi.models.TokenType.Aad,
          settings: {
            filterPaneEnabled: false,
            navContentPaneEnabled: true
          }
        };

        const reportContainer = document.getElementById("reportContainer");
        powerbi.embed(reportContainer, embedConfig);

        startSwitching();
      } catch (err) {
        console.error("Authentication or embedding failed:", err);
      }
    }

    function startSwitching() {
      const report = document.getElementById("reportContainer");
      const video = document.getElementById("videoContainer");
      let showVideo = false;

      report.style.display = "block";

      setInterval(() => {
        showVideo = !showVideo;
        report.style.display = showVideo ? "none" : "block";
        video.style.display = showVideo ? "block" : "none";

        if (showVideo) {
          document.getElementById("video").play();
        }
      }, 60000); // switch every 60 seconds
    }

    signInAndEmbed();
  </script>
</body>
</html>
